import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as e,c as t,b as s,d as n,e as c,a as l}from"./app-e75ceed8.js";const r={},i=l(`<h1 id="_005-springboot日志管理" tabindex="-1"><a class="header-anchor" href="#_005-springboot日志管理" aria-hidden="true">#</a> 005-SpringBoot日志管理</h1><h2 id="_1-为什么要用日志" tabindex="-1"><a class="header-anchor" href="#_1-为什么要用日志" aria-hidden="true">#</a> 1- 为什么要用日志？</h2><p>日志就是记录发生了什么。为啥要记录发生了什么呢？想象⼀下，如果程序报错了，不让你打开控制台看⽇志，那么你能找到报错的原因吗？因此我们需要记录程序的行为，通过这些行为能让我们更好的发现和定位错误所在位置。</p><p>除了发现和定位问题之外，还可以通过⽇志实现以下功能：</p><ul><li>记录⽤户登录⽇志，⽅便分析⽤户是正常登录还是恶意破解⽤户。</li><li>记录系统的操作⽇志，⽅便数据恢复和定位操作⼈。</li><li>记录程序的执⾏时间，⽅便为以后优化程序提供数据⽀持。</li></ul><h2 id="_2-springboot默认日志管理" tabindex="-1"><a class="header-anchor" href="#_2-springboot默认日志管理" aria-hidden="true">#</a> 2-SpringBoot默认日志管理</h2><h3 id="_2-1-日志分类" tabindex="-1"><a class="header-anchor" href="#_2-1-日志分类" aria-hidden="true">#</a> 2.1 日志分类</h3><p>Java 中的日志框架主要分为两大类：</p><p><strong>日志门面</strong>：日志门面定义了一组日志的接口规范，它并不提供底层具体的实现逻辑。<code>Apache Commons Logging</code> 和 <code>Slf4j</code> 就属于这一类。</p><p><strong>日志实现</strong>：日志实现是日志具体的实现，包括日志级别控制、日志打印格式、日志输出形式（输出到数据库、输出到文件、输出到控制台等）。<code>Log4j</code>、<code>Log4j2</code>、<code>Logback</code> 以及 <code>Java Util Logging</code> 则属于这一类。</p><p>将日志门面和日志实现分离其实是一种典型的门面模式，这种方式可以让具体业务在不同的日志实现框架之间自由切换，而不需要改动任何代码，开发者只需要掌握日志门面的 API 即可。</p><p>日志门面是不能单独使用的，它必须和一种具体的日志实现框架相结合使用。那么日志框架是否可以单独使用呢？</p><p>技术上来说当然没问题，但是我们一般不会这样做，因为这样做可维护性很差，而且后期扩展不易。</p><p>SpringBoot 底层采用 Slf4j + Logback 作为默认的日志系统，同时提供了一个名为 <code>spring-boot-starter-logging</code> 的 Starter 为常见的日志框架（如 Log4j 等）提供了自动化配置。</p><figure><img src="https://cdn.jsdelivr.net/gh/mengyahui/image-repository@master/springboot/image-20230715211030742.2o7s796z7560.png" alt="image-20230715211030742" tabindex="0" loading="lazy"><figcaption>image-20230715211030742</figcaption></figure><h3 id="_2-2-日志级别" tabindex="-1"><a class="header-anchor" href="#_2-2-日志级别" aria-hidden="true">#</a> 2.2 日志级别</h3><p>Logback 默认提供的日志级别从低到高分别为：</p><ol><li>TRACE：最低级别的日志，用于记录程序的详细信息，通常用于排查问题；</li><li>DEBUG：用于记录程序的调试信息，通常用于开发和测试阶段；</li><li>INFO：用于记录程序的运行状态信息，通常用于记录程序的启动、关闭等信息；</li><li>WARN：用于记录警告信息，表示程序可能存在潜在的问题，但不会影响程序的正常运行；</li><li>ERROR：最高级别的日志，用于记录程序中的错误信息，通常在程序出现异常时使用。</li></ol><p>SpringBoot 应用，日志默认输出到控制台，日志级别包含：ERROR、WARN 和 INFO，这是因为 SpringBoot 默认的日志级别是 INFO，若要开启 DEBUG 级别的日志，可以在 application.yml 配置文件中配置如下内容：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">debug</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>但是在实际项目中，日志通常的配置如下：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">logging</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">level</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">root</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">info</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">com.example.controller</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">debug</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">com.example.service</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">debug</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，root 表示组表示整个项目，同时也可以为不同的包指定不同的日志级别，这会覆盖 root 的日志级别。</p><p>像上面那样以包为单位设置日志级别是很麻烦的，此时可以将相同日志级别的包定义到同一个组中，再为组设置日志级别，就像下面这样：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">logging</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">group</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">server</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">com.example.service, com.example.controller</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">sql</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">com.example.mapper</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">level</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">root</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">info</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">server</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">debug</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">sql</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">trace</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-打印日志" tabindex="-1"><a class="header-anchor" href="#_2-3-打印日志" aria-hidden="true">#</a> 2.3 打印日志</h3><p>SpringBoot 打印日志，通常需要先获取日志对象，具体如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#4EC9B0;">RestController</span></span>
<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#4EC9B0;">RequestMapping</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;/user&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;">public</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">UserController</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">public</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">static</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">final</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Logger</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">log</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">LoggerFactory</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getLogger</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">UserController</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除此之外，获取日志对象也可以使用 Lombok 的 <code>@Slf4j</code> 注解替代：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#4EC9B0;">Slf4j</span></span>
<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#4EC9B0;">RestController</span></span>
<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#4EC9B0;">RequestMapping</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;/user&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;">public</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">UserController</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>拿到日志对象后，调用相应的方法即可打印不同级别的日志，<code>{}</code> 可以作为日志输出的占位符，数据在之后传入，如：<code>log.error(&quot;用户id：{}不存在&quot;,userId)</code></p><h3 id="_2-4-自定义日志格式" tabindex="-1"><a class="header-anchor" href="#_2-4-自定义日志格式" aria-hidden="true">#</a> 2.4 自定义日志格式</h3><p>在 SpringBoot 项目的配置文件中添加如下配置，可以自定义日志输出格式：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">logging</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">pattern</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">file</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;%d{yyyy-MM-dd} [%thread] %-5level %logger{50} - %msg%n&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">console</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;%d{yyyy-MM-dd hh:mm:ss} [%thread] %-5level %logger{50} - %msg%n&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是常用日志配置参数的说明：</p>`,35),D=s("thead",null,[s("tr",null,[s("th",null,"配置参数"),s("th",null,"说明")])],-1),y=s("tr",null,[s("td",{"yyyy-MM-dd":"","HH:mm:ss,":"",SSS:""},"%d"),s("td",null,"日志生产时间，输出到毫秒的时间")],-1),d=s("tr",null,[s("td",null,"%-5level"),s("td",null,"输出日志级别，-5 表示左对齐并且固定输出 5 个字符，如果不足在右边补 0")],-1),u=s("tr",null,[s("td",null,"%logger 或 %c"),s("td",null,"logger 的名称")],-1),v=s("tr",null,[s("td",null,"%thread 或 %t"),s("td",null,"输出当前线程名称")],-1),g=s("td",null,"%message 或 %msg 或 %m",-1),m={href:"http://logger.info",target:"_blank",rel:"noopener noreferrer"},C=s("tr",null,[s("td",null,"%class 或 %C"),s("td",null,"输出 Java 类名")],-1),b=s("tr",null,[s("td",null,"%method 或 %M"),s("td",null,"输出方法名")],-1),h=s("tr",null,[s("td",null,"hostName"),s("td",null,"本地机器名")],-1),E=s("tr",null,[s("td",null,"hostAddress"),s("td",null,"本地 ip 地址")],-1),f=l(`<h3 id="_2-5-持久化日志" tabindex="-1"><a class="header-anchor" href="#_2-5-持久化日志" aria-hidden="true">#</a> 2.5 持久化日志</h3><p>SpringBoot 日志的默认配置，只会输出日志到控制台，但是在生产环境通常都需要将日志持久化到文件中，实现也很简单，只需要在配置文件添加几个简单的配置即可：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">logging</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">file</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;"># 指定日志文件名字和路径</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;"># name: D:\\\\logs\\\\run.log</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;"># 指定日志文件路径，不能指定日志文件的名字，固定为 spring.log</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">path</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">log/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><ol><li><code>logging.file.name</code> 和 <code>logging.file.path</code> 只需要配置一个，若同时存在，则 path 无效；</li><li>默认情况下，日志文件的大小达到 10MB 时会切分一次，产生新的日志文件</li></ol></div><h2 id="_3-logback日志文件" tabindex="-1"><a class="header-anchor" href="#_3-logback日志文件" aria-hidden="true">#</a> 3-Logback日志文件</h2><p>在 SpringBoot 配置文件中对日志进行的配置只适用一些简单的场景，对于比较负杂的场景，像区分 info 和 error 的日志、每天产生一个日志文件等场景，使用配置文件实现则更加合适。</p><p>SpringBoot 为各个日志实现配置了默认的配置文件名，只需要将日志文件放到 resources 目录下，即可被正确加载。以 Logback 为例，SpringBoot 默认支持的配置文件名为：</p><ul><li>logback-spring.xml</li><li>logback-spring.groovy</li><li>logback.xml</li><li>logback.groovy</li></ul><p>Spring 官方推荐优先使用带有 <code>-spring</code> 的文件名作为日志配置，这是因为命名为 logback-spring.xml 配置文件不会被日志框架直接加载，而是由 SpringBoot 解析日志配置文件，这意味着我们可以在 logback-spring.xml 配置文件中添加一些 SpringBoot 特有的配置项，比如获取 <code>application.yml</code> 中定义的数据，这是在 logback.xml 中是无法获取的。</p><p>除此之外，SpringBoot 还支持在 <code>application.yml</code> 使用如下配置自定义配置日志文件名：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#569CD6;">logging</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">config</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">classpath:logback-core.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>下面给出一个 Logback 的常用配置文件，实际开发可根据该配置文件进行修改：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="shiki dark-plus" style="background-color:#1E1E1E;" tabindex="0"><code><span class="line"><span style="color:#808080;">&lt;?</span><span style="color:#569CD6;">xml</span><span style="color:#9CDCFE;"> version</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;1.0&quot;</span><span style="color:#9CDCFE;"> encoding</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;UTF-8&quot;</span><span style="color:#808080;">?&gt;</span></span>
<span class="line"><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">configuration</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">scan</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;true&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">scanPeriod</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;60 seconds&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">debug</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;false&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">&lt;!-- 日志存放路径 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">property</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;log.path&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;logs/gt&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">   </span><span style="color:#6A9955;">&lt;!-- 日志输出格式 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">property</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;log.pattern&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">value</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{20} - [%method,%line] - %msg%n&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">&lt;!-- 控制台输出 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;console&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.pattern}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">appender</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">&lt;!-- 系统日志输出 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;file_info&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	    </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">file</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.path}/info.log</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">file</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#6A9955;">&lt;!-- 循环政策：基于时间创建日志文件 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">rollingPolicy</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 日志文件名格式 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">fileNamePattern</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.path}/info.%d{yyyy-MM-dd}.log</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">fileNamePattern</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#6A9955;">&lt;!-- 日志最大的历史 60天 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">maxHistory</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">60</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">maxHistory</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">rollingPolicy</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.pattern}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">filter</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 过滤的级别 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">level</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">INFO</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">level</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 匹配时的操作：接收（记录） --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">onMatch</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">ACCEPT</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">onMatch</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 不匹配时的操作：拒绝（不记录） --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">onMismatch</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">DENY</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">onMismatch</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">filter</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">appender</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;file_error&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	    </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">file</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.path}/error.log</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">file</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#6A9955;">&lt;!-- 循环政策：基于时间创建日志文件 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">rollingPolicy</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 日志文件名格式 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">fileNamePattern</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.path}/error.%d{yyyy-MM-dd}.log</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">fileNamePattern</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#6A9955;">&lt;!-- 日志最大的历史 60天 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">maxHistory</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">60</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">maxHistory</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">rollingPolicy</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">\${log.pattern}</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">pattern</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">encoder</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">filter</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">class</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;">&lt;!-- 过滤的级别 --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">level</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">ERROR</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">level</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#6A9955;">&lt;!-- 匹配时的操作：接收（记录） --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">onMatch</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">ACCEPT</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">onMatch</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">			</span><span style="color:#6A9955;">&lt;!-- 不匹配时的操作：拒绝（不记录） --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">onMismatch</span><span style="color:#808080;">&gt;</span><span style="color:#D4D4D4;">DENY</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">onMismatch</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">filter</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">appender</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">&lt;!-- 系统模块日志级别控制  --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">logger</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;com.g&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">level</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;info&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">&lt;!-- Spring日志级别控制  --&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">logger</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">name</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;org.springframework&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">level</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;warn&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">root</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">level</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;info&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">		</span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender-ref</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;console&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">root</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span></span>
<span class="line"><span style="color:#D4D4D4;">	</span><span style="color:#6A9955;">&lt;!--系统操作日志--&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">root</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">level</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;info&quot;</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender-ref</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;file_info&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#808080;">&lt;</span><span style="color:#569CD6;">appender-ref</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">ref</span><span style="color:#D4D4D4;">=</span><span style="color:#CE9178;">&quot;file_error&quot;</span><span style="color:#D4D4D4;"> </span><span style="color:#808080;">/&gt;</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">root</span><span style="color:#808080;">&gt;</span></span>
<span class="line"><span style="color:#808080;">&lt;/</span><span style="color:#569CD6;">configuration</span><span style="color:#808080;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13);function q(_,k){const a=p("ExternalLinkIcon");return e(),t("div",null,[i,s("table",null,[D,s("tbody",null,[y,d,u,v,s("tr",null,[g,s("td",null,[n("日志内容，即 "),s("a",m,[n("logger.info"),c(a)]),n('("message")')])]),C,b,h,E])]),f])}const A=o(r,[["render",q],["__file","005-SpringBoot日志管理.html.vue"]]);export{A as default};
